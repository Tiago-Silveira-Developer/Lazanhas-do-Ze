<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carrinho - Lasanhas do Zé</title>
  <link rel="stylesheet" href="../css/reset.css" />
  <link rel="stylesheet" href="../css/headerConfig.css" />
  <link rel="stylesheet" href="../mainConfig.css" />
  <link rel="stylesheet" href="../css/carrinho.css" />
</head>

<body>
  <header>
    <div id="logo"><a href="../index.html"><img src="../src/logoTeste.png" alt="Logo Lasanhas do Zé" /></a></div>
    <div id="topMenu">
      <div id="cardapio"><a href="cardapio.html" class="linkBtn">Cardápio</a></div>
      <div id="contato"><a href="contato.html" class="linkBtn">Contato</a></div>
      <div id="carrinho"><a href="carrinho.html" class="linkBtn">Carrinho</a></div>
    </div>
  </header>

  <main style="padding: 20px;">
    <h2>Seu Carrinho</h2>
    <div id="carrinho-container"></div>

    <div id="resumo" style="margin-top: 30px;">
      <p><strong>Total:</strong> R$ <span id="total">0.00</span></p>
      <button id="enviarPedido" class="btnPadrao">Enviar Pedido via WhatsApp</button>
      <button id="limparCarrinho" class="btnPadrao btnPerigo">Limpar Carrinho</button>
    </div>

  </main>

  <script>
    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    const container = document.getElementById("carrinho-container");
    const totalSpan = document.getElementById("total");

    function renderizarCarrinho() {
      container.innerHTML = "";
      let total = 0;

      carrinho.forEach((item, index) => {
        const subtotal = item.preco * item.quantidade;
        total += subtotal;

        const div = document.createElement("div");
        div.style.margin = "10px 0";
        div.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: center; gap: 10px; flex-wrap: wrap;">
          <p><strong>${item.nome}</strong><br>R$ ${item.preco.toFixed(2)} x ${item.quantidade} = <strong>R$ ${subtotal.toFixed(2)}</strong></p>
          <button onclick="removerItem(${index})" class="btnPadrao btnPerigo">Remover</button>
          </div>
          <hr>
        `;

        container.appendChild(div);
      });

      totalSpan.textContent = total.toFixed(2);
    }

    function removerItem(index) {
      carrinho.splice(index, 1);
      localStorage.setItem("carrinho", JSON.stringify(carrinho));
      renderizarCarrinho();
    }

    document.getElementById("limparCarrinho").addEventListener("click", () => {
      if (confirm("Deseja realmente esvaziar o carrinho?")) {
        localStorage.removeItem("carrinho");
        carrinho = [];
        renderizarCarrinho();
      }
    });

    document.getElementById("enviarPedido").addEventListener("click", () => {
      if (carrinho.length === 0) {
        alert("Seu carrinho está vazio.");
        return;
      }

      let texto = carrinho.map(item => `• ${item.nome} x${item.quantidade} - R$ ${(item.preco * item.quantidade).toFixed(2)}`).join('%0A');
      let total = carrinho.reduce((soma, item) => soma + (item.preco * item.quantidade), 0);

      const link = `https://wa.me/5551992251930?text=Olá!%20Gostaria%20de%20fazer%20um%20pedido:%0A${texto}%0A%0ATotal:%20R$%20${total.toFixed(2)}`;
      window.open(link, "_blank");
    });

    renderizarCarrinho();
  </script>

  <script>
    const car = JSON.parse(localStorage.getItem("carrinho")) || [];
    const badge = document.getElementById("badgeQtd");
    if (badge) {
    const totalItens = car.reduce((acc, item) => acc + item.quantidade, 0);
    badge.textContent = `(${totalItens})`;
    }
  </script>
  
</body>

</html>